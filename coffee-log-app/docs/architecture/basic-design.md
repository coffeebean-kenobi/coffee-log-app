# 基本設計

## システムアーキテクチャ

Coffee Log Appは、Next.jsをベースとしたフロントエンドとSupabaseをバックエンドとするシステムアーキテクチャを採用しています。

### アーキテクチャ概要図

```
┌─────────────┐      ┌───────────────┐      ┌─────────────────┐
│             │      │               │      │                 │
│  クライアント  ├─────►  Next.js App  ├─────►    Supabase     │
│  (ブラウザ)   │      │  (Vercel)    │      │  (BaaS)        │
│             │      │               │      │                 │
└─────────────┘      └───────────────┘      └─────────────────┘
```

## アプリケーション層構造

### フロントエンド (Next.js)

- **App Router**: Next.js 14のApp Routerを使用したルーティング
- **Server Components & Client Components**: 適切な使い分けによるパフォーマンス最適化
- **ディレクトリ構造**:
  - `app/`: ルーティングとページコンポーネント
  - `components/`: 再利用可能なUIコンポーネント
  - `lib/`: ユーティリティ関数とサービス（Supabase接続など）
  - `types/`: TypeScript型定義
  - `utils/`: ヘルパー関数

### バックエンド (Supabase)

- **認証システム**: メール/パスワード認証
- **データベース**: PostgreSQLベースのデータ管理
- **ストレージ**: 画像ファイル保存用のストレージバケット
- **APIエンドポイント**: RESTful APIによるデータアクセス

## セキュリティ設計

- **認証・認可**: Supabase Authによるセキュアな認証
- **Row Level Security (RLS)**: ユーザーごとのデータアクセス制限
- **CORS設定**: 許可されたオリジンからのアクセスのみ許可
- **環境変数管理**: 機密情報の安全な管理

## データフロー

1. ユーザーがブラウザでアプリにアクセス
2. Next.jsアプリケーションがサーバーコンポーネントをレンダリング
3. サーバーコンポーネントがSupabaseからデータを取得
4. クライアントコンポーネントがインタラクティブな機能を提供
5. ユーザーのアクションがSupabaseに保存される

## スケーラビリティ

- Vercelのサーバーレスインフラによる自動スケーリング
- Supabaseのクラウドホスティングによるデータベースのスケーラビリティ
- 静的生成とキャッシングによるパフォーマンス最適化 